<!doctype html>
<html lang="it">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="vite.svg" />
  <link rel="manifest" href="/manifest.webmanifest">
  <link rel="apple-touch-icon" href="/icon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#6366f1">
  <title>DigiShoppingCard</title>
</head>

<body>
  <div id="app">
    <header>
      <div class="header-titles">
        <h1 data-i18n="app_title">DigiShoppingCard</h1>
        <span class="header-subtitle" data-i18n="app_subtitle">Le mie carte</span>
      </div>
      <button id="settingsBtn" class="icon-btn" aria-label="Impostazioni">
        <i data-lucide="settings"></i>
      </button>
    </header>

    <main class="container">
      <div class="search-container">
        <input type="text" id="searchInput" placeholder="Cerca carta..." data-i18n-placeholder="search_placeholder">
        <i data-lucide="search" class="search-icon"></i>
      </div>

      <div id="cardGrid" class="card-grid">
        <!-- Cards will be rendered here -->
      </div>

      <div id="emptyState" class="empty-state">
        <div class="empty-state-icon">ü™™</div>
        <p>Non hai ancora aggiunto nessuna carta.</p>
        <p>Tocca il tasto + per iniziare!</p>
      </div>
    </main>

    <button id="addCardBtn" class="fab" aria-label="Aggiungi Carta" data-i18n-aria="aria_add_card">
      <span id="fabIcon">+</span>
    </button>

    <!-- Modal for Adding/Editing Card -->
    <div id="addModal" class="modal-overlay">
      <div class="modal-content">
        <button class="close-modal" id="closeAddModal">‚úï</button>
        <h2 data-i18n="new_card_title">Nuova Carta</h2>

        <div class="form-group">
          <div id="reader"></div>
          <div id="uploadStatus"></div>
          <div class="btn-group">
            <button id="startScanBtn" class="btn btn-secondary">
              <span data-i18n="scan_btn">Scansiona Barcode</span>
            </button>
          </div>
        </div>



        <div class="form-group">
          <label data-i18n="store_name_label">Nome Negozio</label>
          <input type="text" id="storeName" placeholder="Es. Esselunga, Carrefour..."
            data-i18n-placeholder="store_name_placeholder">
        </div>

        <div class="form-group">
          <label data-i18n="category_label">Categoria</label>
          <select id="cardCategory" class="language-select" data-i18n-aria="category_label">
            <option value="other" data-i18n="cat_other">Altro</option>
            <option value="groceries" data-i18n="cat_groceries">Spesa</option>
            <option value="fashion" data-i18n="cat_fashion">Abbigliamento</option>
            <option value="tech" data-i18n="cat_tech">Elettronica</option>
            <option value="health" data-i18n="cat_health">Salute</option>
            <option value="home" data-i18n="cat_home">Casa</option>
          </select>
        </div>

        <div class="form-group">
          <label data-i18n="barcode_label">Codice Barcode</label>
          <input type="text" id="barcodeValue" placeholder="Inserisci il codice manualmente"
            data-i18n-placeholder="barcode_placeholder">
        </div>

        <div class="btn-group">
          <button id="saveCardBtn" class="btn btn-primary" data-i18n="save_btn">Salva Carta</button>
        </div>
      </div>
    </div>

    <!-- Modal for Fullscreen View -->
    <div id="viewModal" class="modal-overlay">
      <div class="modal-content fullscreen-card">
        <button class="close-modal" id="closeViewModal">‚úï</button>

        <div class="card-detail-info">
          <div id="viewStoreName" class="card-detail-name">Nome Negozio</div>
          <div id="viewBarcodeValue" class="card-detail-code">123456789</div>
        </div>

        <div id="barcodeCanvasContainer" class="barcode-display">
          <!-- Barcode SVG/Canvas will be here -->
        </div>

        <div class="btn-group-view">
          <button id="closeViewBtn" class="btn btn-secondary" data-i18n="close_btn">Chiudi</button>
          <button id="deleteCardBtn" class="btn btn-danger" data-i18n="delete_btn">Elimina Carta</button>
        </div>
      </div>
    </div>

    <!-- Modal for Settings (Backup/Restore) -->
    <div id="settingsModal" class="modal-overlay">
      <div class="modal-content">
        <button class="close-modal" id="closeSettingsModal">‚úï</button>
        <h2 data-i18n="settings_title">Impostazioni</h2>

        <div class="settings-section">
          <h3 data-i18n="security_section">Sicurezza</h3>
          <div class="setting-item">
            <span data-i18n="biometric_lock">Blocco Biometrico (FaceID/TouchID)</span>
            <label class="switch">
              <input type="checkbox" id="biometricToggle" data-i18n-aria="biometric_lock">
              <span class="slider round"></span>
            </label>
          </div>
        </div>

        <div class="settings-section">
          <h3 data-i18n="language_section">Lingua</h3>
          <select id="languageSelect" class="language-select" aria-label="Seleziona Lingua"
            data-i18n-aria="aria_select_language">
            <option value="it">Italiano</option>
            <option value="en">English</option>
            <option value="es">Espa√±ol</option>
            <option value="fr">Fran√ßais</option>
            <option value="de">Deutsch</option>
            <option value="pt">Portugu√™s</option>
            <option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</option>
            <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
            <option value="id">Bahasa Indonesia</option>
          </select>
        </div>

        <p class="settings-desc" data-i18n="settings_desc">Gestisci i tuoi dati in locale o esportali per sicurezza.</p>
        <div class="settings-section">
          <h3 data-i18n="backup_section">Backup e Ripristino</h3>
          <p data-i18n="backup_desc">Esporta i tuoi dati su iCloud o Google Drive salvando il file sul dispositivo. Puoi
            ripristinarli caricando lo stesso file.</p>

          <div class="btn-group">
            <button id="exportBtn" class="btn btn-primary">
              <i data-lucide="download"></i> <span data-i18n="export_btn">Esporta Backup (.json)</span>
            </button>
            <label for="importFile" class="btn btn-secondary">
              <i data-lucide="upload"></i> <span data-i18n="import_btn">Importa Backup (.json)</span>
              <input type="file" id="importFile" accept=".json" class="hidden-input">
            </label>
          </div>
        </div>

        <div class="settings-info">
          <p>Versione 1.3.0</p>
          <p data-i18n="storage_info">Tutti i dati sono salvati solo sul tuo dispositivo.</p>
          <p class="privacy-note" data-i18n="privacy_note">La funzione di geolocalizzazione utilizza OpenStreetMap per
            verificare i negozi nelle vicinanze. Nessun dato identificativo viene inviato.</p>
        </div>
      </div>
    </div>

    <!-- Lock Screen Overlay -->
    <div id="lockScreen" class="lock-screen-overlay">
      <div class="lock-content">
        <div class="lock-icon-wrapper">
          <i data-lucide="lock" class="lock-icon"></i>
        </div>
        <h2 data-i18n="app_locked">App Bloccata</h2>
        <p data-i18n="auth_required">Usa il FaceID o TouchID per accedere alle tue carte.</p>
        <button id="unlockBtn" class="btn btn-primary" data-i18n="unlock_btn">Sblocca</button>
      </div>
    </div>
  </div>
  <script type="module" src="src/main.js"></script>
</body>

</html>